# Лабораторная работа №1 Отчёт

## Функциональное программирование

### Студент: 
|Имя        |Группа      | № в группе |Оценка|
|------------|-----------|-----------------|----|
|Бойцов Иван |М8О-312Б-22| 23              |    |

## Решание вычислительных задач в функциональном стиле

### Задание 1: Ряд Тейлора

Исходя из моего номера в списке, моя функция - это:
$$f(x) = arctg(x)$$
и ряд Маклорена:
$$f(x) = x - {x^{3} \over 3} + … + (-1)^{n} {x^{2n+1}\over 2n + 1}$$

Исходя из задания, необходимо вычислить значения функции на заданном 
интервале [0.0, 0.5] тремя способами:
  * С помощью встроенных функций F#
    ```fs
    // Функция вычисления с помощью встроенных функций F#
    let f x : float = float(System.Math.Atan x)
    ```
  * Используя наивный способ, по формуле ряда $$x - {x^{3} \over 3} + … + (-1)^{n} {x^{2n+1}\over 2n + 1}$$
    ```fs
    // Наивный способ вычисления ряда Тейлора, где каждый член вычисляется по формуле
    let newAcc = acc + ((-1.) ** float(n)) * (x ** (2. * float n + 1.)) / (2. * float n + 1.)
    ```
  
  * Используя умный способ, т.е. вычисление следующего члена на основе предыдущего $$x_{n+1} = - x_n * {x^2\over {2n + 1}}$$
    ```fs
    // Умный способ вычисления ряда Тейлора, где каждый член вычисляется через предыдущий
    let newPrev = -prev * (x ** 2.0) / float (2 * n + 1)
    ```

Полный код программы: [Taylor.fs](FP_Lab01_FSharp/Taylor.fs)

Таблица:

| x    | Builtin  | Smart Taylor | # terms | Dumb Taylor | # terms |
|------|----------|--------------|---------|-------------|---------|
| 0.00 | 0.000000 | 0.000000     | 0       | 0.000000    | 0       |
| 0.05 | 0.039958 | 0.039958     | 1       | 0.039958    | 1       |
| 0.10 | 0.099669 | 0.099667     | 2       | 0.099667    | 2       |
| 0.15 | 0.148890 | 0.148875     | 3       | 0.148890    | 3       |
| 0.20 | 0.197396 | 0.197333     | 4       | 0.197397    | 4       |
| 0.25 | 0.244979 | 0.244792     | 5       | 0.244987    | 5       |
| 0.30 | 0.291457 | 0.300000     | 6       | 0.291455    | 6       |
| 0.35 | 0.336675 | 0.335708     | 7       | 0.336667    | 7       |
| 0.40 | 0.380506 | 0.378667     | 8       | 0.380510    | 8       |
| 0.45 | 0.422854 | 0.419625     | 9       | 0.422852    | 9       |
| 0.50 | 0.463648 | 0.458333     | 10      | 0.463640    | 10      |

![image](https://github.com/user-attachments/assets/786e6164-b725-4993-a187-e297e6559b08)

### Задание 2: Численное решение трансцендентных функций

Три уравнения, исходя из номера группы это (23-25):
  1. $$3x - 4ln(x) - 5 = 0$$  
  2. $$cos({2\over x}) - 2sin({1\over x}) + {1 \over x} = 0$$
  3. $$arccos(x) - \sqrt{1 - 0.3x^3} = 0 $$

### Метод Дихотомии

Для этого метода нам понадобятся границы отрезка, в которых находится корень уравнения.
Помимо этого функция должна быть монотонной на этом отрезке. Мы вычисляем значение 
функции в середине этого отрезка и заменяем правую или левую границу отрезка на его середину. 
С каждой итерацией длина отрезка будет уменьшаться в два раза, и вскоре мы получим корень 
уравнения с требуемым приближением.

  ```fs
  // Метод деления пополам (дихотомия)
  let rec dichotomy f (a:float) (b:float) =
    let eps = 0.000001
    let xn = (a + b) / 2.
    let fa = f a
    let fb = f b

    if abs(f xn) < eps then
        xn
    elif fa < fb then
        if (f xn) < 0. then dichotomy f xn b else dichotomy f a xn
    else
        if (f xn) > 0. then dichotomy f xn b else dichotomy f a xn
  ```

### Метод итераций

Для данного метода нам необходимо выразить  $x = \varphi (x)$ из каждого уравнения $f(x) = 0$:
  1. $$x = {4lnx + 5 \over 3}$$
  2. $$x = {2 \over acos(2sin({1\ over x} - {1 \over x}))}$$
  3. $$x = sin( \sqrt{1 - 0.4x^{2}})$$

  ```fs
  // Метод итерации
  let rec iterations phi x0 = 
    let eps = 0.000001

    if abs(x0 - (phi x0)) < eps then
        x0
    else
        let next = phi x0
        iterations phi next
  ```

После этого мы высчитываем $x_n = \varphi(x_{n - 1})$ выбирая такой $x_0$, который будет ближе к корню уравнения.

### Метод Ньютона

Метод Ньютона это частный случай метода итерацйи, в котором мы используем $\varphi(x) = x - {f(x)\over f'(x)}$.
Для этого мы высчитываем производную каждой функции:
  1. $${3x - 4\over x} = 0 $$
  2. $${2cos({1\over x}) + 2sin({2\over x}) \over x^2} - {1 \over x^2} = 0 $$
  3. $$-{2x \over 5\sqrt{1 - {2x^2 \over 5}}} - {1 \over \sqrt{1 = x^2}} = 0 $$

  ```fs
  // Метод Ньютона
  let rec newthon f f' x0 = 
    let phi x: float = x - (f x) / (f' x)
    // Используя метод итерации
    iterations phi x0
  ```

Полный код программы [equations.fs](FP_Lab01_FSharp/equations.fs)

Таблица:

|# |Bisection|Iterations|Newton |
|--|---------|----------|-------|
|23| 3.22996 | 3.22996  | 3.22996 |
|24| 1.87562 | 1.87562  | 1.87562 |
|25| 0.76716 | 0.76716  | 0.76716 |

![image](https://github.com/user-attachments/assets/0828da5c-a55c-4d4f-8b86-2d1ea153ab4b)

### Вывод

Данная лабораторная работа познакомила меня с основами функционального языка F# на примерах
вычислительных задач. Она также заставила меня вспомнить пары математического анализа для
того чтобы разобраться в написании умного метода поиска следующего члена ряда через предыдущий.
Во второй части у меня возникало много проблем с выражением второго уравнения через x и проходом его
методом итераций. Однако у меня все получилось и результаты совпали.
